
        <article class="routes">
            <style>
                ul.routes
                {
                    display: flex;
                    flex-direction: column;
                    gap: 1em;
                }
                .routes .route
                {
                    border: solid 1px;
                    border-radius: 3px;
                    padding: .5em;
                    /* order: 1; */
                    transition: all 100ms linear;
                }
                .routes .route.tag
                {
                    border-color: highlight;
                }
                .routes .route:not(.match)
                {
                    border-color: graytext;
                    scale: .9;
                    /* order: 2; */
                }
                .routes .route:not(.match) > p
                {
                    color: graytext;
                }
                .routes .route header
                {
                    font-size: 1em;
                    font-weight: bold;
                }
                .routes .route:not(.match) > header
                {
                    color: graytext;
                }
            </style>
            <header>Routes</header>
            <div class="description">
                <p>Dialogs can only be routed to by their direct parent router. Cannot use a subroute to open a dialog on a nested router. If you want to open a dialog on a nested router, using a path on the parent router, add a search parameter and handle it in the beforeopen event.</p>
            </div>
            <div class="example">
                <div class="paths">
                    <ul class="page">
                        <li>/</li>
                        <li>partA</li>
                        <li>partA/partB</li>
                        <li>partA/:propertyA</li>
                        <li>partA/:propertyA/partB</li>
                        <li>partA/:propertyA/partB/:propertyB</li>
                    </ul>
                    <ul class="dialog">
                        <li>#partC</li>
                        <li>#partC/partD</li>
                        <li>#partC/:propertyA</li>
                        <li>#partC/:propertyA/partD</li>
                        <li>#partC/:propertyA/partD/:propertyB</li>
                    </ul>
                </div>
                <div class="query">
                    <div class="search">
                        <input type="search" class="current-path" />
                    </div>
                    <div class="properties">
                        <header>Properties</header>
                        <ul class="properties"></ul>
                    </div>
                </div>
                <ul class="routes">
                    <li class="route" data-test="1" data-property-test="2">
                        <header><span class="title">Tag:</span><span class="tag">No Route</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">[empty string]|[no parameter]|/</span></p>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                    </li>
                    <li class="route" path="partA/partB">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Part B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/partB</span></p>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A - Part B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                        <ul>
                            <li class="route" path="partB">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path=":propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                    </li>
                    <li class="route" path="partA/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/:propertyA</span></p>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A - Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                        <ul>
                            <li class="route tag" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA/partB/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Part B / Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/partB/:propertyA</span></p>
                    </li>
                    <li class="route" path="partA/partB">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Part B - Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/partB</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A - Part B / Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                        <ul>
                            <li class="route" path="partB/:propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB/:propertyA</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A - Part B - Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                        <ul>
                            <li class="route" path="partB">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB</span></p>
                                <ul>
                                    <li class="route" path=":propertyA">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA/:propertyA/partB">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Property A / Part B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/:propertyA/partB</span></p>
                    </li>
                    <li class="route" path="partA/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Property A - Part B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/:propertyA</span></p>
                        <ul>
                            <li class="route" path="partB">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A - Property A - Part B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                <ul>
                                    <li class="route" path="partB">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB</span></p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA/:propertyA/partB/:propertyB">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Property A / Part B / Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/:propertyA/partB/:propertyB</span></p>
                    </li>
                    <li class="route" path="partA/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part A / Property A - Part B / Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA/:propertyA</span></p>
                        <ul>
                            <li class="route" path="partB/:propertyB">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB/:propertyB</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A - Property A - Part B / Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                <ul>
                                    <li class="route" path="partB/:propertyB">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB/:propertyB</span></p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="route" path="partA">
                        <header><span class="title">Tag:</span><span class="tag">Part A - Property A - Part B - Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partA</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                <ul>
                                    <li class="route" path="partB">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partB</span></p>
                                        <ul>
                                            <li class="route" path=":propertyB">
                                                <header>Subroute</header>
                                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyB</span></p>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC">
                        <header><span class="title">Tag:</span><span class="tag">Part C</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                    </li>
                    <li class="route dialog" path="partC/partD">
                        <header><span class="title">Tag:</span><span class="tag">Part C / Dialog Part D</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC/partD</span></p>
                    </li>
                    <li class="route dialog" path="partC">
                        <header><span class="title">Tag:</span><span class="tag">Part C - Dialog Part D</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                        <ul>
                            <li class="route" path="partD">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part C / Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC/:propertyA</span></p>
                    </li>
                    <li class="route dialog" path="partC/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part C - Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC/partD/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part C / Part D / Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC/partD/:propertyA</span></p>
                    </li>
                    <li class="route dialog" path="partC">
                        <header><span class="title">Tag:</span><span class="tag">Part C - Part D / Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                        <ul>
                            <li class="route" path="partD/:propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD/:propertyA</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC">
                        <header><span class="title">Tag:</span><span class="tag">Part C - Part D - Property A</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                        <ul>
                            <li class="route" path="partD">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD</span></p>
                                <ul>
                                    <li class="route" path=":propertyA">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC/:propertyA/partD">
                        <header><span class="title">Tag:</span><span class="tag">Part C / Property A / Part D</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC/:propertyA/partD</span></p>
                    </li>
                    <li class="route dialog" path="partC/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part C / Property A - Part D</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC/:propertyA</span></p>
                        <ul>
                            <li class="route" path="partD">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC">
                        <header><span class="title">Tag:</span><span class="tag">Part C - Property A - Part D</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                <ul>
                                    <li class="route tag" path="partD">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD</span></p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC/:propertyA/partD/:propertyB">
                        <header><span class="title">Tag:</span><span class="tag">Part C / Property A / Part D / Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC/:propertyA/partD/:propertyB</span></p>
                    </li>
                    <li class="route dialog" path="partC/:propertyA">
                        <header><span class="title">Tag:</span><span class="tag">Part C / Property A - Part D / Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC/:propertyA</span></p>
                        <ul>
                            <li class="route" path="partD/:propertyB">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD/:propertyB</span></p>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC">
                        <header><span class="title">Tag:</span><span class="tag">Part C - Property A - Part D / Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                <ul>
                                    <li class="route" path="partD/:propertyB">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD/:propertyB</span></p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="route dialog" path="partC">
                        <header><span class="title">Tag:</span><span class="tag">Part C - Property A - Part D - Property B</span></header>
                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partC</span></p>
                        <ul>
                            <li class="route" path=":propertyA">
                                <header>Subroute</header>
                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyA</span></p>
                                <ul>
                                    <li class="route" path="partD">
                                        <header>Subroute</header>
                                        <p class="expected-match"><span class="title">Should Match:</span><span class="value">partD</span></p>
                                        <ul>
                                            <li class="route" path=":propertyB">
                                                <header>Subroute</header>
                                                <p class="expected-match"><span class="title">Should Match:</span><span class="value">:propertyB</span></p>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <script type="module">
                // const basicRouter = document.querySelector('article.basic path-router');

                const routing_pageRoutes = [...document.querySelectorAll('article.routes .routes .route:not(.dialog)')];
                const routing_dialogRoutes = [...document.querySelectorAll('article.routes .routes .route.dialog')];
                const routing_routes = [...routing_pageRoutes, ...routing_dialogRoutes];
                document.addEventListener('DOMContentLoaded', () =>
                {
                    // const linksParent = document.querySelector('article.basic menu');
                    // basicRouter.addRouteLinkClickHandlers(linksParent);
                    
                    const currentPathInput = document.querySelector('article.routes input.current-path');
                    openRoutes(currentPathInput.value);

                    currentPathInput.addEventListener('change', (event) =>
                    {
                        const input = event.currentTarget;
                        const path = input.value;
                        openRoutes(path);
                        console.log(path);
                    });
                });

                function openRoutes(path)
                {
                    for(let i = 0; i < routing_routes.length; i++)
                    {
                        const route = routing_routes[i];
                        route.classList.remove('match');
                        const [ routeMatches, properties ] = routeMatchesPath(route, path, route.classList.contains('dialog'));
                        for(const [key, value] of Object.entries(properties))
                        {
                            const dataKey = propertyKeyword + key.substring(0, 1).toUpperCase() + key.substring(1);
                            route.dataset[dataKey] = value;
                        }
                        if(routeMatches == true)
                        {
                            beforeOpenRoute(route);
                            route.classList.add('match');
                        }
                    }
                }

                function beforeOpenRoute(route, path)
                {
                    console.log('before-open');
                    const properties = getRouteProperties(route, path);
                    console.log(properties);
                }

                function routeMatchesPath(route, queryPath, isDialog = false)
                {
                    // console.log(route, queryPath);
                    const routePath = route.getAttribute('path') ?? "";

                    // handle special cases / early exits
                    if(routePath.trim() == "" || routePath == "/" && isDialog == false)
                    {
                        return [ (queryPath.trim() == "" || queryPath == "/"), [] ];
                    }

                    if(routePath.trim() == queryPath.trim() && isDialog == false)
                    {
                        return [ true, [] ];
                    }
                    
                    // split query path into page and dialog paths
                    const queryPathArray = queryPath.split('#');
                    const pagePath = queryPathArray[0];
                    const dialogPath = (queryPathArray.length > 1) ? queryPathArray[1] : null;

                    // break paths into arrays
                    const routePathArray = routePath.split('/');
                    const pagePathArray = pagePath.split('/');

                    // determine path type;
                    // if a route is nested in a dialog, we still want
                    // to use the dialog part of the route to handle
                    // the matching for that nested route.
                    const pathType = route.closest('.dialog') == null
                    ? 'Page'
                    : 'Dialog';

                    // handle page path matching
                    if(pathType == "Page")
                    {
                        return routeTypeMatches(route, pagePathArray, routePathArray);
                    }
                    else if(dialogPath == null)
                    {
                        return [ false, [] ] ;
                    }

                    // handle dialog path matching
                    const dialogPathArray = dialogPath.split('/');
                    return routeTypeMatches(route, dialogPathArray, routePathArray);
                }

                const propertyKeyword = 'property';
                function routeTypeMatches(route, queryPathArray, routePathArray, parentRouteSelector = '.route')
                {
                    if(queryPathArray.length == 1 && queryPathArray[0].trim() == "")
                    {
                        return [ false, [] ];
                    }
                    // compose parent paths into a single path (if this is a nested route)
                    const parentRoutes = [];
                    let parentRoute = route.parentElement?.closest(parentRouteSelector);
                    while(parentRoute != null)
                    {
                        // early exit for nested items; only match if
                        // parents have already matched
                        if(parentRoute.classList.contains('match') == false) { return [ false, [] ]; }

                        parentRoutes.push(parentRoute);
                        parentRoute = parentRoute.parentElement?.closest(parentRouteSelector);
                    }
                    let composedParentPath = parentRoutes.reverse().reduce((accumulation, item, index) =>
                    {
                        return `${(accumulation == "") ? "" : accumulation + '/'}${item.getAttribute('path') ?? ""}`;
                    }, "");

                    // filter out matching parent routes
                    const parentRouteArray = composedParentPath.split('/');
                    let subrouteArray = [...queryPathArray].filter((item, index) =>
                    {
                        const parentRouteElement = parentRouteArray[index];
                        const parentRouteElementIsProperty = parentRouteElement?.startsWith(':');
                        return !(parentRouteElementIsProperty == true || parentRouteElement == item)
                    });

                    // check if the remaining paths match
                    let { match, properties } = pathArraySelectsRouteArray(subrouteArray, routePathArray);

                    return [ match, properties ];
                }

                function getRouteProperties(route)
                {
                    const dataValues = Object.entries(route.dataset);

                    const properties = dataValues.reduce((result, item) =>
                    {
                        const dataItemName = item[0];
                        if(!dataItemName.startsWith(propertyKeyword)) { return result; }

                        const key = dataItemName[propertyKeyword.length].toLowerCase() // lowercase first letter of property name
                        + dataItemName.substring(propertyKeyword.length + 1); // remove keyword and first letter of property name
                        const value = item[1];

                        result[key] = value;
                        return result;
                    }, {});

                    return properties;
                }
                
                function pathArraySelectsRouteArray(pathArray, routeArray)
                {
                    let properties = {};
                    if(routeArray.length > pathArray.length)
                    {
                        return { match: false, properties };
                    }
                    let routeMatchesPath = false;
                    // let lastRouteSlugPermitsMatch = false;
                    for(let i = 0; i < pathArray.length; i++)
                    {
                        const routeSlug = routeArray[i];
                        const pathSlug = pathArray[i];

                        if(routeSlug == null)
                        {
                            // there is no more matching left to do
                            return { match: routeMatchesPath, properties };
                        }

                        // if(pathSlug == null)
                        // {
                        //     return { match: false, resolved: false };
                        // }

                        const isParameter = routeSlug.startsWith(':');
                        if(isParameter == false)
                        {
                            if(routeSlug != pathSlug)
                            {
                                return { match: false, properties };
                            }
                        }
                        else
                        {
                            properties[routeSlug.substring(1)] = pathSlug;
                        }

                        // if(slug == WILDCARD_CHARACTER)
                        // {
                        //     routeMatchesPath = true;
                        //     lastRouteSlugPermitsMatch = true;
                        //     break;
                        // }


                        routeMatchesPath = true;
                        // lastRouteSlugPermitsMatch = isParameter;
                    }
                    return { match: routeMatchesPath, properties };
                }
            </script>
        </article>